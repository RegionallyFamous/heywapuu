(()=>{"use strict";var e,a={183(){const e=window.wp.element,a=window.wp.data,t=window.wp.i18n,__=(e,a)=>"undefined"!=typeof window&&window.wp&&window.wp.i18n?window.wp.i18n.__(e,a):e,n=[{id:"core/add-new-post",label:__("Create a new post","hey-wapuu"),explanation:__("Open the editor to start a new blog post.","hey-wapuu"),descriptions:["write a story","make a new blog post","create a post","new post","tell a secret","new article","share a thought","start a post"],url:"post-new.php"},{id:"core/add-new-page",label:__("Create a new page","hey-wapuu"),explanation:__("Open the editor to create a new static page.","hey-wapuu"),descriptions:["create a new page","make a static page","new about page","new contact page","add a page"],url:"post-new.php?post_type=page"},{id:"core/manage-posts",label:__("Manage all posts","hey-wapuu"),explanation:__("View and edit your existing blog posts.","hey-wapuu"),descriptions:["show all posts","view post list","manage my articles","all my stories"],url:"edit.php"},{id:"core/manage-categories",label:__("Manage categories","hey-wapuu"),explanation:__("Organize your posts into categories.","hey-wapuu"),descriptions:["manage categories","edit categories","post categories"],url:"edit-tags.php?taxonomy=category"},{id:"core/manage-tags",label:__("Manage tags","hey-wapuu"),explanation:__("Organize your posts using tags.","hey-wapuu"),descriptions:["manage tags","edit tags","post tags"],url:"edit-tags.php?taxonomy=post_tag"},{id:"core/manage-pages",label:__("Manage all pages","hey-wapuu"),explanation:__("View and edit your existing static pages.","hey-wapuu"),descriptions:["show all pages","view page list","manage pages","all my pages"],url:"edit.php?post_type=page"},{id:"core/open-media-library",label:__("Open media library","hey-wapuu"),explanation:__("View and manage your images, videos, and files.","hey-wapuu"),descriptions:["show pictures","find images","open gallery","uploaded files","photos library","manage media"],url:"upload.php"},{id:"core/add-new-media",label:__("Add new media","hey-wapuu"),explanation:__("Upload new files to your media library.","hey-wapuu"),descriptions:["upload image","add photo","new video","upload file","add media"],url:"media-new.php"},{id:"core/open-appearance-themes",label:__("Manage themes","hey-wapuu"),explanation:__("Change the appearance and design of your site.","hey-wapuu"),descriptions:["change look","find design","new theme","manage themes","appearance"],url:"themes.php"},{id:"core/open-site-editor",label:__("Open site editor","hey-wapuu"),explanation:__("Edit your site layout and design globally.","hey-wapuu"),descriptions:["edit site","change layout","full site editing","open editor","customize theme"],url:"site-editor.php"},{id:"core/open-navigation",label:__("Manage navigation","hey-wapuu"),explanation:__("Edit your site menus and navigation.","hey-wapuu"),descriptions:["edit navigation","change menus","site navigation"],url:"site-editor.php?path=%2Fnavigation"},{id:"core/open-styles",label:__("Edit site styles","hey-wapuu"),explanation:__("Change global colors, fonts, and styles.","hey-wapuu"),descriptions:["edit styles","change colors","typography","global styles"],url:"site-editor.php?path=%2Fstyles"},{id:"core/open-templates",label:__("Manage templates","hey-wapuu"),explanation:__("Edit page and post templates.","hey-wapuu"),descriptions:["show templates","manage blueprints","edit templates"],url:"site-editor.php?path=%2Ftemplates"},{id:"core/open-template-parts",label:__("Manage template parts","hey-wapuu"),explanation:__("Edit headers, footers, and other template components.","hey-wapuu"),descriptions:["show template parts","edit header","edit footer"],url:"site-editor.php?path=%2Ftemplate-parts"},{id:"core/open-patterns",label:__("Manage patterns","hey-wapuu"),explanation:__("Create and manage reusable block patterns.","hey-wapuu"),descriptions:["manage patterns","show patterns","reusable blocks"],url:"site-editor.php?path=%2Fpatterns"},{id:"core/open-appearance-menus",label:__("Manage menus","hey-wapuu"),explanation:__("Edit your navigation menus.","hey-wapuu"),descriptions:["change menu","edit navigation","fix links","menu settings"],url:"nav-menus.php"},{id:"core/open-appearance-widgets",label:__("Manage widgets","hey-wapuu"),explanation:__("Edit sidebars and footers using widgets.","hey-wapuu"),descriptions:["change widgets","edit sidebar","add footer blocks","manage widgets"],url:"widgets.php"},{id:"core/open-appearance-customizer",label:__("Open customizer","hey-wapuu"),explanation:__("Customize your site appearance with live preview.","hey-wapuu"),descriptions:["open customizer","change colors","header settings","site identity"],url:"customize.php"},{id:"core/manage-users",label:__("Manage users","hey-wapuu"),explanation:__("View and manage all site users.","hey-wapuu"),descriptions:["show users","view team","manage people","who is here"],url:"users.php"},{id:"core/add-new-user",label:__("Add new user","hey-wapuu"),explanation:__("Create a new user account for your site.","hey-wapuu"),descriptions:["add user","new member","invite person","create account"],url:"user-new.php"},{id:"core/open-user-profile",label:__("Edit my profile","hey-wapuu"),explanation:__("Manage your personal account settings.","hey-wapuu"),descriptions:["my profile","edit me","change my password","my account","who am i"],url:"profile.php"},{id:"core/manage-comments",label:__("Manage comments","hey-wapuu"),explanation:__("View and moderate site comments.","hey-wapuu"),descriptions:["show comments","see feedback","read messages","who commented"],url:"edit-comments.php"},{id:"core/open-plugins",label:__("Manage plugins","hey-wapuu"),explanation:__("View and manage your installed plugins.","hey-wapuu"),descriptions:["add features","manage extensions","installed plugins","new tools"],url:"plugins.php"},{id:"core/add-new-plugin",label:__("Add new plugin","hey-wapuu"),explanation:__("Search for and install new plugins.","hey-wapuu"),descriptions:["install plugin","search plugins","add new plugin"],url:"plugin-install.php"},{id:"core/open-settings-general",label:__("General settings","hey-wapuu"),explanation:__("Manage core site settings and information.","hey-wapuu"),descriptions:["site title","change description","general settings","change name"],url:"options-general.php"},{id:"core/open-settings-writing",label:__("Writing settings","hey-wapuu"),explanation:__("Manage settings related to post creation.","hey-wapuu"),descriptions:["writing settings","default category","post via email"],url:"options-writing.php"},{id:"core/open-settings-reading",label:__("Reading settings","hey-wapuu"),explanation:__("Manage how content is displayed to visitors.","hey-wapuu"),descriptions:["reading settings","homepage settings","how many posts"],url:"options-reading.php"},{id:"core/open-settings-discussion",label:__("Discussion settings","hey-wapuu"),explanation:__("Manage comment settings and moderation rules.","hey-wapuu"),descriptions:["discussion settings","comment rules","avatars"],url:"options-discussion.php"},{id:"core/open-settings-media",label:__("Media settings","hey-wapuu"),explanation:__("Manage image sizes and upload organization.","hey-wapuu"),descriptions:["media settings","image sizes","organize uploads"],url:"options-media.php"},{id:"core/open-settings-permalinks",label:__("Permalink settings","hey-wapuu"),explanation:__("Manage URL structure for your site.","hey-wapuu"),descriptions:["permalink settings","change urls","link structure"],url:"options-permalink.php"},{id:"core/open-settings-privacy",label:__("Privacy settings","hey-wapuu"),explanation:__("Manage your privacy policy and data settings.","hey-wapuu"),descriptions:["privacy settings","privacy policy"],url:"options-privacy.php"},{id:"core/open-tools-available",label:__("Available tools","hey-wapuu"),explanation:__("View additional tools available for your site.","hey-wapuu"),descriptions:["available tools","show all tools"],url:"tools.php"},{id:"core/open-tools-site-health",label:__("Site health","hey-wapuu"),explanation:__("Check your site health and status.","hey-wapuu"),descriptions:["site health","is my site okay","check for problems"],url:"site-health.php"},{id:"core/open-tools-export",label:__("Export content","hey-wapuu"),explanation:__("Export your site content to an XML file.","hey-wapuu"),descriptions:["export content","download my site","back up my stories","save my work"],url:"export.php"},{id:"core/open-tools-import",label:__("Import content","hey-wapuu"),explanation:__("Import content from other sites.","hey-wapuu"),descriptions:["import content","upload site data","bring in stories"],url:"import.php"},{id:"core/open-tools-export-personal-data",label:__("Export personal data","hey-wapuu"),explanation:__("Export personal data for a specific user.","hey-wapuu"),descriptions:["export personal data","privacy export"],url:"export-personal-data.php"},{id:"core/open-tools-erase-personal-data",label:__("Erase personal data","hey-wapuu"),explanation:__("Erase personal data for a specific user.","hey-wapuu"),descriptions:["erase personal data","privacy erase"],url:"erase-personal-data.php"},{id:"core/open-updates",label:__("Check for updates","hey-wapuu"),explanation:__("Check for WordPress core, plugin, and theme updates.","hey-wapuu"),descriptions:["check for updates","update wordpress","update plugins","new versions"],url:"update-core.php"},{id:"core/toggle-distraction-free",label:__("Distraction-free mode","hey-wapuu"),explanation:__("Hide editor sidebars and toolbars for focused writing.","hey-wapuu"),descriptions:["distraction free mode","hide sidebar","clean editor","focus mode"]},{id:"core/toggle-spotlight-mode",label:__("Spotlight mode","hey-wapuu"),explanation:__("Focus on the currently selected block.","hey-wapuu"),descriptions:["spotlight mode","focus on block","dim other blocks"]},{id:"core/toggle-list-view",label:__("Show list view","hey-wapuu"),explanation:__("View the hierarchical structure of your blocks.","hey-wapuu"),descriptions:["list view","show blocks","outline","document structure"]},{id:"core/toggle-fullscreen-mode",label:__("Fullscreen mode","hey-wapuu"),explanation:__("Toggle fullscreen editing mode.","hey-wapuu"),descriptions:["fullscreen mode","max editor","big screen"]},{id:"core/toggle-feature-welcome-guide",label:__("Welcome guide","hey-wapuu"),explanation:__("Open the editor welcome guide.","hey-wapuu"),descriptions:["welcome guide","how to use editor","tutorial"]},{id:"core/toggle-fixed-toolbar",label:__("Fixed toolbar","hey-wapuu"),explanation:__("Fix the block toolbar to the top of the editor.","hey-wapuu"),descriptions:["fixed toolbar","top toolbar"]},{id:"core/open-preferences",label:__("Editor preferences","hey-wapuu"),explanation:__("Manage your editor settings and preferences.","hey-wapuu"),descriptions:["editor preferences","change settings"]},{id:"core/open-keyboard-shortcuts",label:__("Keyboard shortcuts","hey-wapuu"),explanation:__("View a list of available keyboard shortcuts.","hey-wapuu"),descriptions:["keyboard shortcuts","hotkeys"]},{id:"core/open-dashboard",label:__("Go to dashboard","hey-wapuu"),explanation:__("Return to the main WordPress dashboard.","hey-wapuu"),descriptions:["go home","main menu","wp-admin","start page","back to start"],url:"index.php"},{id:"core/view-site",label:__("View site","hey-wapuu"),explanation:__("View the public front-end of your site.","hey-wapuu"),descriptions:["show my website","visit site","preview live","how does it look","open front end"],url:"/"},{id:"wapuu/tell-joke",label:__("Tell a joke","hey-wapuu"),explanation:__("I can tell you a WordPress-related joke.","hey-wapuu"),descriptions:["tell me a joke","make me laugh","say something funny"],action:"joke"},{id:"wapuu/who-are-you",label:__("About me","hey-wapuu"),explanation:__("Learn more about who I am.","hey-wapuu"),descriptions:["who are you","what is a wapuu","tell me about yourself"],action:"about"},{id:"wapuu/sing-song",label:__("Sing a song","hey-wapuu"),explanation:__("I can sing a short song about WordPress.","hey-wapuu"),descriptions:["sing a song","can you sing","make music","sing for me"],action:"song"},{id:"wapuu/why-warm-up",label:__("Warming up","hey-wapuu"),explanation:__("Learn why I need to warm up my brain.","hey-wapuu"),descriptions:["why","why are you warming up","what are you doing"],action:"why"},{id:"wapuu/how-to-build",label:__("Building a site","hey-wapuu"),explanation:__("I can give you tips on building a great site.","hey-wapuu"),descriptions:["how to build","help me build","give me tips","how do i start","website advice"],action:"tips"},{id:"wapuu/what-can-you-do",label:__("Help","hey-wapuu"),explanation:__("See a list of all commands I can help with.","hey-wapuu"),descriptions:["help","what can you do","show me everything","commands list","capabilities"],action:"help"},{id:"wapuu/site-status",label:__("Site status","hey-wapuu"),explanation:__("Get a quick overview of your site status.","hey-wapuu"),descriptions:["site status","how is the site","check up","health"],action:"status"}],s=e=>{if(!e||"string"!=typeof e)return"";let a=e.replace(/[&<>"']/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[e]));return a=a.replace(/&lt;strong&gt;(.*?)&lt;\/strong&gt;/g,"<strong>$1</strong>"),a},i=window.ReactJSXRuntime,o=({text:a,speed:t=25,onComplete:n})=>{const[o,r]=(0,e.useState)(""),u=(0,e.useRef)(0),l=(0,e.useRef)(0);(0,e.useEffect)(()=>{let e;const s=i=>{if(l.current||(l.current=i),i-l.current>=t){if(!(u.current<a.length))return void(n&&n());r(a.slice(0,u.current+1)),u.current++,l.current=i}e=window.requestAnimationFrame(s)};return e=window.requestAnimationFrame(s),()=>window.cancelAnimationFrame(e)},[a,t,n]);const p=s(o).replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>");return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{dangerouslySetInnerHTML:{__html:p}}),u.current<a.length&&(0,i.jsx)("span",{className:"hw-typewriter-cursor"})]})},r=({type:e,data:a,onAction:n})=>{const s={drafts:(0,t.__)("Continue Writing","hey-wapuu"),updates:(0,t.__)("Updates Available","hey-wapuu"),media:(0,t.__)("Media Library Update","hey-wapuu"),post:(0,t.__)("Next Steps","hey-wapuu")};return(0,i.jsxs)("div",{className:"hw-action-card",children:[(0,i.jsx)("div",{className:"hw-card-header",children:(0,i.jsx)("span",{children:s[e]||(0,t.__)("Suggestion","hey-wapuu")})}),(0,i.jsx)("div",{className:"hw-card-body",children:a.message}),(0,i.jsxs)("div",{className:"hw-card-footer",children:[a.secondaryAction&&(0,i.jsx)("button",{className:"hw-card-btn is-secondary",onClick:()=>n(a.secondaryAction.id),children:a.secondaryAction.label}),(0,i.jsx)("button",{className:"hw-card-btn",onClick:()=>n(a.primaryAction.id),children:a.primaryAction.label})]})]})},u=()=>{const u=window.heyWapuuConfig||{},[l,p]=(0,e.useState)(!1),[d,c]=(0,e.useState)(""),[h,w]=(0,e.useState)(()=>{try{const e=sessionStorage.getItem("hey_wapuu_history");return(e?JSON.parse(e):[]).map(e=>({...e,hasTyped:!0}))}catch(e){return[]}}),[g,y]=(0,e.useState)("idle"),[m,b]=(0,e.useState)([]),[f,x]=(0,e.useState)(!1),[v,k]=(0,e.useState)("happy"),[_,C]=(0,e.useState)(!1),S=(0,e.useRef)(null),j=(0,e.useRef)(null),N=(0,e.useRef)(null),E=(0,e.useRef)(null),T=(0,e.useRef)(null),M=(0,e.useMemo)(()=>({firstName:s(u.user?.firstName||(0,t.__)("Friend","hey-wapuu"))}),[u.user?.firstName]),I=((0,e.useMemo)(()=>({name:s(u.site?.name||(0,t.__)("your site","hey-wapuu")),draftCount:parseInt(u.site?.draftCount||0,10),pendingComments:parseInt(u.site?.pendingComments||0,10),mediaCount:parseInt(u.site?.mediaCount||0,10),hasUpdates:!!u.site?.hasUpdates,activePlugins:parseInt(u.site?.activePlugins||0,10),postCount:parseInt(u.site?.postCount||0,10)}),[u.site]),(0,e.useMemo)(()=>u.context||{},[u.context])),O=(0,e.useCallback)(()=>{window.navigator?.vibrate&&window.navigator.vibrate(10)},[]),W=(0,e.useCallback)(()=>{try{const e=new Audio("https://s3.amazonaws.com/freecodecamp/drums/Give_us_a_light.mp3");e.volume=.05;const a=e.play();void 0!==a&&a.catch(()=>{})}catch(e){}},[]),R=(0,e.useCallback)(e=>n.find(a=>a.id===e)||null,[]),A=(0,e.useCallback)(()=>{window.confirm((0,t.__)("Are you sure you want to clear the chat?","hey-wapuu"))&&(w([]),sessionStorage.removeItem("hey_wapuu_history"))},[]),L=(()=>{const[a,n]=(0,e.useState)([]);return(0,e.useEffect)(()=>{const e=()=>{const e=document.querySelectorAll("#adminmenu a.wp-has-submenu, #adminmenu a.menu-top"),a=[];e.forEach(e=>{const n=e.innerText.replace(/\d+/g,"").replace(/<[^>]*>?/gm,"").trim(),s=e.getAttribute("href");n&&s&&!a.some(e=>e.label===n)&&(e=>!!e&&(e.startsWith("/")||e.startsWith("admin.php")||e.includes("wp-admin")))(s)&&a.push({id:`dynamic/${s}`,label:n,url:s,explanation:(0,t.sprintf)(/* translators: %s: menu label */ /* translators: %s: menu label */
(0,t.__)("Open the %s page","hey-wapuu"),n),isDynamic:!0})}),n(e=>JSON.stringify(e)===JSON.stringify(a)?e:a)};if("complete"!==document.readyState)return window.addEventListener("load",e),()=>window.removeEventListener("load",e);e()},[]),a})(),F=(0,e.useCallback)(e=>R(e)||L.find(a=>a.id===e),[L,R]),z=(0,e.useCallback)(()=>{x(!1),w(e=>[...e,{role:"ai",text:(0,t.__)("I encountered an error. Please try again.","hey-wapuu"),hasTyped:!1}])},[]),P=(0,e.useCallback)(e=>{const{matches:a,isLive:n}=e;if(n)return b(a),y(a.length>0?"results":"searching"),void(a.length>0&&"happy"===v&&(k("thinking"),setTimeout(()=>k("happy"),600)));y("idle"),x(!1),k("wiggle"),b(a);const s=a.length>0?F(a[0].id):null;let i;if(s){const e=[(0,t.sprintf)(/* translators: 1: user first name, 2: command explanation */ /* translators: 1: user first name, 2: command explanation */
(0,t.__)("I can help with that, %1$s. %2$s","hey-wapuu"),M.firstName,s.explanation),(0,t.sprintf)(/* translators: %s: user first name */ /* translators: %s: user first name */
(0,t.__)("You got it, %s.","hey-wapuu"),M.firstName)];i=e[Math.floor(Math.random()*e.length)]}else i=(0,t.__)("Hmm, I don't know that yet. Try asking something else!","hey-wapuu");w(e=>[...e,{role:"ai",text:i,hasTyped:!1}]),setTimeout(()=>k("happy"),1500)},[M.firstName,v,F]),{workerStatus:D,loadingProgress:U,isReadyNotification:V,isStuck:$,forceRestart:q,postToWorker:H}=(({dynamicCommands:a,onResults:t,onError:n})=>{const[s,i]=(0,e.useState)("idle"),[o,r]=(0,e.useState)(0),[u,l]=(0,e.useState)(!1),[p,d]=(0,e.useState)(Date.now()),c=(0,e.useRef)(null),h=(0,e.useCallback)(()=>{c.current&&(c.current.terminate(),c.current=null),i("idle"),d(Date.now())},[]),w=(0,e.useMemo)(()=>("initializing"===s||"loading"===s)&&Date.now()-p>15e3,[s,p]);(0,e.useEffect)(()=>{const e=void 0!==window.BroadcastChannel?new BroadcastChannel("hey_wapuu_sync"):null;let a=null;return"idle"===s&&(a=setTimeout(()=>{if(!c.current&&window.Worker){i("initializing");try{const a=heyWapuuConfig.workerUrl;c.current=new Worker(a,{type:"module"}),c.current.postMessage({type:"init",data:{embeddingsUrl:heyWapuuConfig.embeddingsUrl,modelUrl:heyWapuuConfig.modelUrl,version:heyWapuuConfig.version}}),c.current.onmessage=a=>{const{type:s,data:o}=a.data;if("status"===s)if("ready"===o.status)i("ready"),r(100),l(!0),setTimeout(()=>l(!1),3e3),e?.postMessage({type:"ready"});else if("loading"===o.status)i("loading");else if("downloading"===o.status){if(i("downloading"),o.percent){const a=parseInt(o.percent,10);isNaN(a)||(r(a),e?.postMessage({type:"progress",percent:a}))}}else"error"===o.status&&i("error");else"error"===s?n():"results"===s&&t(o)},c.current.onerror=e=>{console.error("Wapuu Trace: Worker Error ->",e),i("error")}}catch(e){console.error("Wapuu Trace: Boot Exception ->",e),i("error")}}},500)),()=>{a&&clearTimeout(a),c.current&&"error"===s&&(c.current.terminate(),c.current=null),e?.close()}},[s,n,t]),(0,e.useEffect)(()=>{"ready"===s&&a.length>0&&c.current&&c.current.postMessage({type:"learn",data:{commands:a}})},[s,a]);const g=(0,e.useCallback)(e=>{c.current&&c.current.postMessage(e)},[]);return{workerStatus:s,loadingProgress:o,isReadyNotification:u,isStuck:w,forceRestart:h,postToWorker:g}})({dynamicCommands:L,onResults:P,onError:z}),J=(0,e.useCallback)(e=>{const a=(e||d).trim();a&&(O(),w(e=>[...e,{role:"user",text:a}]),e||c(""),y("thinking"),x(!0),k("thinking"),"ready"===D?H({type:"query",data:{text:a,context:I.postType||I.screenId}}):setTimeout(()=>{x(!1),k("happy"),w(e=>[...e,{role:"ai",text:(0,t.__)("I am still loading...","hey-wapuu"),hasTyped:!1}])},600))},[d,D,I,O,H]),B=(0,e.useCallback)(e=>{c(e),setTimeout(()=>J(e),500)},[J]),{isListening:K,toggleListening:G}=(a=>{const[t,n]=(0,e.useState)(!1),s=(0,e.useRef)(null);(0,e.useEffect)(()=>{const e=window.SpeechRecognition||window.webkitSpeechRecognition;return e&&(s.current=new e,s.current.continuous=!1,s.current.interimResults=!1,s.current.lang="en-US",s.current.onresult=e=>{const t=e.results[0][0].transcript;n(!1),a(t)},s.current.onerror=()=>n(!1),s.current.onend=()=>n(!1)),()=>{s.current&&s.current.stop()}},[a]);const i=(0,e.useCallback)(()=>{if(t)s.current?.stop();else try{n(!0),s.current?.start()}catch(e){n(!1)}},[t]);return{isListening:t,toggleListening:i}})(B),{executeCommand:X}=(0,a.useDispatch)("core/commands"),Y=(0,a.useSelect)(e=>e("core/commands").getCommands(),[]),Q=(0,e.useCallback)(e=>{const a=F(e);a&&(b([]),w(e=>[...e,{role:"ai",text:(0,t.__)("Navigating to your destination.","hey-wapuu"),isTransient:!0}]),k("celebrate"),sessionStorage.setItem("hey_wapuu_arrival",JSON.stringify({id:e,label:a.label,time:Date.now()})),setTimeout(()=>{if(Y.some(a=>a.name===e))X(e),p(!1);else if(a.url){const e="undefined"!=typeof ajaxurl?ajaxurl.replace("admin-ajax.php",""):"/wp-admin/";window.location.href=a.url.startsWith("/")?a.url:e+a.url}},800))},[Y,X,F]);(0,e.useCallback)(e=>{"help"===e&&w(e=>[...e,{role:"ai",text:(0,t.__)("I can help you navigate WordPress. Try asking for the media library or a new post.","hey-wapuu")}])},[]),(0,e.useEffect)(()=>{if(d.trim()){if("ready"===D)return y("searching"),T.current&&clearTimeout(T.current),T.current=setTimeout(()=>{H({type:"query",data:{text:d,context:I.postType||I.screenId,dynamicCommands:L,isLive:!0}})},400),()=>clearTimeout(T.current)}else"searching"===g&&(y("idle"),b([]))},[d,D,L,I,g,H]),(0,e.useEffect)(()=>{h.length>0&&sessionStorage.setItem("hey_wapuu_history",JSON.stringify(h.slice(-50))),h.length>0&&"ai"===h[h.length-1].role&&W()},[h,W]),(0,e.useEffect)(()=>{const e=e=>{if((e.altKey||e.ctrlKey&&!e.metaKey)&&"KeyW"===e.code)return p(e=>!e),void e.preventDefault();l&&"Escape"===e.key&&(p(!1),e.preventDefault(),N.current?.focus())};return window.addEventListener("keydown",e,!0),()=>window.removeEventListener("keydown",e,!0)},[l]),(0,e.useEffect)(()=>{l&&setTimeout(()=>j.current?.focus(),100)},[l]),(0,e.useEffect)(()=>{0===h.length&&w([{role:"ai",text:(0,t.sprintf)(/* translators: %s: user first name */ /* translators: %s: user first name */
(0,t.__)("Hi %s, how can I help you today?","hey-wapuu"),M.firstName),isInitial:!0,hasTyped:!1}])},[h.length,M.firstName]),(0,e.useEffect)(()=>{C("thinking"===v||"celebrate"===v)},[v]),(0,e.useEffect)(()=>{const e=sessionStorage.getItem("hey_wapuu_arrival");if(e){try{const{label:a}=JSON.parse(e);setTimeout(()=>{w(e=>[...e.filter(e=>!e.isTransient),{role:"ai",text:(0,t.sprintf)(/* translators: %s: destination label */ /* translators: %s: destination label */
(0,t.__)("You have arrived at: **%s**.","hey-wapuu"),a),hasTyped:!1}]),p(!0),k("celebrate"),setTimeout(()=>k("happy"),2e3)},500)}catch(e){}sessionStorage.removeItem("hey_wapuu_arrival")}},[]);const Z=["hw-summoner",l?"is-active":"",V?"is-ready-notification":"",`mood-${v}`].filter(Boolean).join(" ");return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("button",{ref:N,className:Z,onClick:()=>$?q():p(!l),"aria-expanded":l,"aria-label":(0,t.__)("Toggle Chat","hey-wapuu"),children:$?"ðŸ”„":l?"Ã—":"ðŸ’¬"}),l&&(0,i.jsxs)("div",{className:"hw-chat-window "+(_?"is-glowing":""),role:"dialog","aria-label":(0,t.__)("Wapuu Assistant","hey-wapuu"),ref:E,children:[(0,i.jsxs)("div",{className:"hw-chat-header",children:[(0,i.jsx)("h2",{children:$?(0,t.__)("Restarting...","hey-wapuu"):(0,t.sprintf)(/* translators: %s: user first name */ /* translators: %s: user first name */
(0,t.__)("Hi %s","hey-wapuu"),M.firstName)}),(0,i.jsxs)("div",{className:"hw-header-actions",children:[(0,i.jsx)("button",{onClick:A,className:"hw-clear-btn",title:(0,t.__)("Clear Chat","hey-wapuu"),children:(0,t.__)("Clear","hey-wapuu")}),(0,i.jsx)("button",{onClick:()=>p(!1),className:"hw-close-btn",children:"Ã—"})]})]}),"ready"!==D&&(0,i.jsx)("div",{className:"hw-progress-container",children:(0,i.jsx)("div",{className:"hw-progress-bar",style:{width:`${U}%`}})}),(0,i.jsxs)("div",{className:"hw-chat-content",ref:S,children:[h.map((a,t)=>(0,i.jsxs)(e.Fragment,{children:[(0,i.jsx)("div",{className:`hw-bubble hw-bubble-${a.role}`,children:"ai"!==a.role||a.hasTyped?(0,i.jsx)("span",{dangerouslySetInnerHTML:{__html:s(a.text).replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>")}}):(0,i.jsx)(o,{text:a.text,onComplete:()=>{w(e=>{const a=[...e];return a[t]={...a[t],hasTyped:!0},a})}})}),"card"===a.type&&(0,i.jsx)(r,{type:a.cardType,data:a.data,onAction:Q})]},t)),f&&(0,i.jsx)("div",{className:"hw-bubble hw-bubble-ai hw-thinking",children:"..."})]}),m.length>0&&(0,i.jsx)("div",{className:"hw-suggestions",children:m.map(e=>{const a=F(e.id);return a?(0,i.jsxs)("button",{className:"hw-match-card",onClick:()=>Q(e.id),children:[(0,i.jsx)("strong",{children:a.label}),(0,i.jsx)("span",{children:a.explanation})]},e.id):null})}),(0,i.jsxs)("div",{className:"hw-input-area "+("ready"!==D?"is-disabled":""),children:[(0,i.jsx)("button",{className:"hw-mic-btn "+(K?"is-listening":""),onClick:G,children:K?"ðŸ›‘":"ðŸŽ¤"}),(0,i.jsx)("input",{ref:j,type:"text",value:d,disabled:"ready"!==D,onChange:e=>c(e.target.value),onKeyDown:e=>"Enter"===e.key&&J(),placeholder:"ready"===D?(0,t.__)("Ask me anything...","hey-wapuu"):(0,t.__)("Loading...","hey-wapuu")}),(0,i.jsx)("button",{className:"hw-send-btn",onClick:()=>J(),disabled:"ready"!==D,children:(0,t.__)("Go","hey-wapuu")})]})]})]})},l=()=>{if("undefined"!=typeof wp&&wp.element){const a=document.getElementById("hey-wapuu-root")||(()=>{const e=document.createElement("div");return e.id="hey-wapuu-root",document.body.appendChild(e),e})();(0,e.createRoot)(a).render((0,i.jsx)(u,{}))}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",l):l()}},t={};function n(e){var s=t[e];if(void 0!==s)return s.exports;var i=t[e]={exports:{}};return a[e](i,i.exports,n),i.exports}n.m=a,e=[],n.O=(a,t,s,i)=>{if(!t){var o=1/0;for(p=0;p<e.length;p++){for(var[t,s,i]=e[p],r=!0,u=0;u<t.length;u++)(!1&i||o>=i)&&Object.keys(n.O).every(e=>n.O[e](t[u]))?t.splice(u--,1):(r=!1,i<o&&(o=i));if(r){e.splice(p--,1);var l=s();void 0!==l&&(a=l)}}return a}i=i||0;for(var p=e.length;p>0&&e[p-1][2]>i;p--)e[p]=e[p-1];e[p]=[t,s,i]},n.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a),(()=>{var e={57:0,350:0};n.O.j=a=>0===e[a];var a=(a,t)=>{var s,i,[o,r,u]=t,l=0;if(o.some(a=>0!==e[a])){for(s in r)n.o(r,s)&&(n.m[s]=r[s]);if(u)var p=u(n)}for(a&&a(t);l<o.length;l++)i=o[l],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(p)},t=globalThis.webpackChunkhey_wapuu=globalThis.webpackChunkhey_wapuu||[];t.forEach(a.bind(null,0)),t.push=a.bind(null,t.push.bind(t))})();var s=n.O(void 0,[350],()=>n(183));s=n.O(s)})();