/**
 * Hey Wapuu Styles - Fully Scoped "Perfect" Edition
 */

#hey-wapuu-root {
	--hw-primary: var(--wp-admin-theme-color, #007cba);
	--hw-yellow: #ffce00;
	--hw-font: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
	--hw-dark: #1e1e1e;
	--hw-light: #f0f0f1;
	--hw-radius: 12px;
	--hw-shadow: 0 10px 40px rgba(0,0,0,0.15);
	--hw-glow: rgba(0, 124, 186, 0.3);
}

/* --- ADVANCED GLOW EFFECTS --- */
#hey-wapuu-root .hw-chat-window::before {
	content: "";
	position: absolute;
	top: -2px; left: -2px; right: -2px; bottom: -2px;
	background: linear-gradient(45deg, var(--hw-primary), var(--hw-yellow), var(--hw-primary));
	background-size: 400%;
	z-index: -1;
	filter: blur(10px);
	opacity: 0;
	transition: opacity 0.5s ease;
	border-radius: calc(var(--hw-radius) + 2px);
}

#hey-wapuu-root .hw-chat-window.is-glowing::before {
	opacity: 0.6;
	animation: hw-glow-flow 8s linear infinite;
}

@keyframes hw-glow-flow {
	0% { background-position: 0% 50%; }
	50% { background-position: 100% 50%; }
	100% { background-position: 0% 50%; }
}

/* --- ACTION CARDS --- */
#hey-wapuu-root .hw-action-card {
	background: white;
	border-radius: 12px;
	border: 1px solid #ccd0d4;
	margin-top: 10px;
	overflow: hidden;
	box-shadow: 0 4px 12px rgba(0,0,0,0.08);
	animation: hw-card-slide 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
}

@keyframes hw-card-slide {
	from { transform: translateY(20px); opacity: 0; }
	to { transform: translateY(0); opacity: 1; }
}

#hey-wapuu-root .hw-card-header {
	padding: 10px 15px;
	background: #f6f7f7;
	border-bottom: 1px solid #ccd0d4;
	display: flex;
	align-items: center;
	gap: 8px;
	font-weight: 600;
	font-size: 13px;
	color: #1d2327;
}

#hey-wapuu-root .hw-card-body {
	padding: 15px;
	font-size: 14px;
	color: #3c434a;
}

#hey-wapuu-root .hw-card-footer {
	padding: 8px;
	background: #f6f7f7;
	border-top: 1px solid #ccd0d4;
	display: flex;
	justify-content: flex-end;
}

#hey-wapuu-root .hw-card-btn {
	background: var(--hw-primary);
	color: white;
	border: none;
	padding: 6px 12px;
	border-radius: 6px;
	font-size: 12px;
	font-weight: 600;
	cursor: pointer;
	transition: all 0.2s ease;
}

#hey-wapuu-root .hw-card-btn:hover {
	filter: brightness(1.1);
	transform: translateY(-1px);
}

#hey-wapuu-root .hw-card-btn.is-secondary {
	background: #dcdcde;
	color: #3c434a;
	margin-right: 8px;
}

/* --- TYPEWRITER CURSOR --- */
#hey-wapuu-root .hw-typewriter-cursor {
	display: inline-block;
	width: 2px;
	height: 1.2em;
	background: var(--hw-primary);
	margin-left: 2px;
	vertical-align: middle;
	animation: hw-blink 1s infinite;
}

@keyframes hw-blink {
	0%, 100% { opacity: 1; }
	50% { opacity: 0; }
}

/* Visually hide elements for screen readers */
#hey-wapuu-root .screen-reader-text {
	border: 0;
	clip: rect(1px, 1px, 1px, 1px);
	clip-path: inset(50%);
	height: 1px;
	margin: -1px;
	overflow: hidden;
	padding: 0;
	position: absolute;
	width: 1px;
	word-wrap: normal !important;
}

/* --- THE WAPUU SUMMONER BUTTON --- */
#hey-wapuu-root .hw-summoner {
	position: fixed;
	bottom: 20px;
	right: 20px;
	width: 60px;
	height: 60px;
	background: var(--hw-primary);
	border-radius: 50%;
	box-shadow: 0 4px 15px rgba(0,0,0,0.2);
	display: flex;
	align-items: center;
	justify-content: center;
	cursor: pointer;
	z-index: 999999;
	transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
	border: 3px solid white;
	font-size: 30px;
	padding: 0;
	margin: 0;
	color: white;
	line-height: 1;
	animation: hw-breathe 4s infinite ease-in-out;
	text-align: center;
}

@keyframes hw-breathe {
	0%, 100% { transform: scale(1); box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
	50% { transform: scale(1.05); box-shadow: 0 6px 20px rgba(0,0,0,0.15); }
}

#hey-wapuu-root .hw-summoner.is-active {
	background: white;
	color: var(--hw-primary);
	border-color: var(--hw-primary);
	font-size: 44px;
	font-weight: 300;
	animation: none;
	padding-bottom: 4px; /* Optical adjustment for the × character */
}

#hey-wapuu-root .hw-summoner:hover {
	transform: scale(1.1) rotate(5deg);
}

#hey-wapuu-root .hw-summoner:focus {
	outline: 3px solid var(--hw-primary);
	outline-offset: 2px;
}

/* MOODS */
#hey-wapuu-root .hw-summoner.mood-thinking {
	animation: hw-thinking-pulse 1s infinite ease-in-out;
}

#hey-wapuu-root .hw-summoner.mood-wiggle {
	animation: hw-wiggle 0.3s 2 ease-in-out;
}

#hey-wapuu-root .hw-summoner.mood-celebrate {
	animation: hw-celebrate 0.5s ease-in-out forwards;
}

#hey-wapuu-root .hw-summoner.is-ready-notification {
	animation: hw-ready-wiggle 1.5s ease-in-out 2;
}

@keyframes hw-ready-wiggle {
	0%, 100% { transform: scale(1); }
	10%, 30% { transform: scale(1.1) rotate(-10deg); }
	20%, 40% { transform: scale(1.1) rotate(10deg); }
	50% { transform: scale(1); }
}

@keyframes hw-thinking-pulse {
	0% { transform: scale(1); box-shadow: 0 4px 15px rgba(255, 206, 0, 0.4); }
	50% { transform: scale(1.08); box-shadow: 0 4px 25px rgba(255, 206, 0, 0.7); }
	100% { transform: scale(1); box-shadow: 0 4px 15px rgba(255, 206, 0, 0.4); }
}

@keyframes hw-wiggle {
	0% { transform: rotate(0deg); }
	25% { transform: rotate(10deg); }
	75% { transform: rotate(-10deg); }
	100% { transform: rotate(0deg); }
}

@keyframes hw-celebrate {
	0% { transform: scale(1); }
	50% { transform: scale(1.3) rotate(15deg); }
	100% { transform: scale(1) rotate(0deg); }
}

/* --- THE CHAT WINDOW --- */
#hey-wapuu-root .hw-chat-window {
	position: fixed;
	bottom: 90px;
	right: 20px;
	width: 380px;
	height: 550px;
	max-height: calc(100vh - 120px);
	background: white;
	border-radius: var(--hw-radius);
	box-shadow: var(--hw-shadow);
	z-index: 999998;
	display: flex;
	flex-direction: column;
	overflow: hidden;
	animation: hw-pop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
	border: 1px solid #ccd0d4;
	font-family: var(--hw-font);
}

@keyframes hw-pop {
	from { opacity: 0; transform: translateY(30px) scale(0.9); }
	to { opacity: 1; transform: translateY(0) scale(1); }
}

/* --- MOBILE RESPONSIVENESS --- */
@media (max-width: 600px) {
	#hey-wapuu-root .hw-chat-window {
		bottom: 0;
		right: 0;
		width: 100%;
		height: 100%;
		max-height: 100%;
		border-radius: 0;
		border: none;
	}
	
	#hey-wapuu-root .hw-summoner {
		bottom: 15px;
		right: 15px;
		width: 55px;
		height: 55px;
		font-size: 25px;
	}
}

#hey-wapuu-root .hw-chat-header {
	background: var(--hw-primary);
	padding: 15px 20px;
	display: flex;
	align-items: center;
	justify-content: space-between;
	color: white;
	border-bottom: 2px solid rgba(0,0,0,0.05);
}

#hey-wapuu-root .hw-chat-header h2 {
	margin: 0;
	font-size: 18px;
	font-weight: 700;
	color: inherit;
	background: none;
	padding: 0;
}

#hey-wapuu-root .hw-header-actions {
	display: flex;
	gap: 8px;
	align-items: center;
}

#hey-wapuu-root .hw-help-btn,
#hey-wapuu-root .hw-close-btn {
	background: rgba(255,255,255,0.1);
	border: none;
	color: white;
	cursor: pointer;
	font-size: 16px;
	width: 30px;
	height: 30px;
	border-radius: 50%;
	display: flex;
	align-items: center;
	justify-content: center;
	transition: background 0.2s, transform 0.2s;
	padding: 0;
	line-height: 1;
}

#hey-wapuu-root .hw-clear-btn {
	background: rgba(255,255,255,0.1);
	border: none;
	color: white;
	cursor: pointer;
	font-size: 11px;
	font-weight: 600;
	padding: 4px 10px;
	border-radius: 12px;
	display: flex;
	align-items: center;
	justify-content: center;
	transition: background 0.2s, transform 0.2s;
	text-transform: uppercase;
	letter-spacing: 0.5px;
}

#hey-wapuu-root .hw-clear-btn:hover,
#hey-wapuu-root .hw-help-btn:hover,
#hey-wapuu-root .hw-close-btn:hover {
	background: rgba(255,255,255,0.2);
	transform: scale(1.05);
}

#hey-wapuu-root .hw-help-btn:disabled,
#hey-wapuu-root .hw-clear-btn:disabled {
	opacity: 0.4;
	cursor: not-allowed;
	transform: none !important;
	background: rgba(255,255,255,0.05);
}

#hey-wapuu-root .hw-close-btn {
	font-size: 24px;
	padding-bottom: 3px; /* Optical adjustment for the × character */
}

#hey-wapuu-root .hw-chat-content {
	flex: 1;
	padding: 20px;
	overflow-y: auto;
	display: flex;
	flex-direction: column;
	gap: 15px;
	background: var(--hw-light);
	scroll-behavior: smooth;
}

/* --- BUBBLES --- */
#hey-wapuu-root .hw-bubble {
	padding: 12px 16px;
	border-radius: 16px;
	max-width: 85%;
	font-size: 14px;
	line-height: 1.5;
	position: relative;
	animation: hw-bubble-in 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
}

@keyframes hw-bubble-in {
	0% { transform: scale(0.5) translateY(40px); opacity: 0; }
	70% { transform: scale(1.1) translateY(-5px); opacity: 1; }
	100% { transform: scale(1) translateY(0); opacity: 1; }
}

#hey-wapuu-root .hw-bubble-ai {
	background: white;
	color: var(--hw-dark);
	align-self: flex-start;
	border-bottom-left-radius: 4px;
	border: 1px solid #ccd0d4;
	box-shadow: 0 2px 5px rgba(0,0,0,0.02);
	white-space: pre-wrap;
	overflow: hidden;
}

#hey-wapuu-root .hw-bubble-ai.is-typing::after {
	content: "|";
	animation: hw-blink 0.7s infinite;
	margin-left: 2px;
	color: var(--hw-primary);
	font-weight: bold;
}

@keyframes hw-blink {
	0%, 100% { opacity: 1; }
	50% { opacity: 0; }
}

/* --- MAGIC PARTICLES & CONFETTI --- */
.hw-particle {
	position: fixed;
	pointer-events: none;
	z-index: 1000000;
	font-size: 24px;
	animation: hw-particle-float 1.2s ease-out forwards;
}

@keyframes hw-particle-float {
	0% { transform: translate(0, 0) scale(1) rotate(0deg); opacity: 1; }
	100% { transform: translate(var(--tw-x), var(--tw-y)) scale(0) rotate(var(--tw-r)); opacity: 0; }
}

.hw-confetti {
	position: fixed;
	width: 10px;
	height: 10px;
	background: var(--hw-primary);
	z-index: 1000000;
	pointer-events: none;
	animation: hw-confetti-fall 3s ease-out forwards;
}

@keyframes hw-confetti-fall {
	0% { transform: translate(0, 0) rotate(0deg); opacity: 1; }
	100% { transform: translate(var(--tw-x), 100vh) rotate(var(--tw-r)); opacity: 0; }
}

#hey-wapuu-root .hw-bubble-ai em {
	font-style: italic;
	opacity: 0.8;
	display: block;
	margin-top: 5px;
	font-size: 12px;
}

#hey-wapuu-root .hw-bubble-user {
	background: var(--hw-primary);
	color: white;
	align-self: flex-end;
	border-bottom-right-radius: 4px;
	box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

/* --- QUICK STARTS --- */
#hey-wapuu-root .hw-quick-starts {
	display: flex;
	flex-wrap: wrap;
	gap: 8px;
	margin-top: 12px;
}

#hey-wapuu-root .hw-quick-btn {
	background: var(--hw-light);
	border: 1px solid #ccd0d4;
	border-radius: 20px;
	padding: 6px 14px;
	font-size: 12px;
	font-weight: 600;
	cursor: pointer;
	color: var(--hw-dark);
	transition: all 0.2s ease;
}

#hey-wapuu-root .hw-quick-btn:hover {
	border-color: var(--hw-primary);
	color: var(--hw-primary);
	background: white;
	transform: translateY(-1px);
}

/* --- MATCH CARDS --- */
#hey-wapuu-root .hw-suggestions {
	display: flex;
	flex-direction: column;
	gap: 10px;
	margin-top: 5px;
}

#hey-wapuu-root .hw-match-card {
	background: white;
	border: 1px solid #ccd0d4;
	border-left: 5px solid var(--hw-primary);
	border-radius: 8px;
	padding: 14px;
	cursor: pointer;
	transition: all 0.2s ease;
	display: flex;
	flex-direction: column;
	gap: 4px;
	text-align: left;
	width: 100%;
	box-shadow: 0 2px 5px rgba(0,0,0,0.05);
}

#hey-wapuu-root .hw-match-card:hover {
	background: #f6f7f7;
	transform: translateX(4px);
	box-shadow: 0 4px 10px rgba(0,0,0,0.08);
}

#hey-wapuu-root .hw-match-card strong {
	font-size: 15px;
	color: var(--hw-dark);
}

#hey-wapuu-root .hw-match-card span {
	font-size: 13px;
	color: #666;
}

/* --- INPUT --- */
#hey-wapuu-root .hw-input-area {
	padding: 15px;
	background: white;
	border-top: 1px solid #ccd0d4;
	display: flex;
	gap: 10px;
	align-items: center;
}

#hey-wapuu-root .hw-mic-btn {
	background: #f0f0f1;
	border: 1px solid #ccd0d4;
	border-radius: 50%;
	width: 44px;
	height: 44px;
	display: flex;
	align-items: center;
	justify-content: center;
	cursor: pointer;
	font-size: 18px;
	transition: all 0.2s ease;
	flex-shrink: 0;
}

#hey-wapuu-root .hw-mic-btn:hover {
	background: #e0e0e0;
	transform: scale(1.05);
}

#hey-wapuu-root .hw-mic-btn.is-listening {
	background: #ff4444;
	color: white;
	border-color: #cc0000;
	animation: hw-mic-pulse 1.2s infinite;
}

@keyframes hw-mic-pulse {
	0% { box-shadow: 0 0 0 0 rgba(255, 68, 68, 0.4); }
	70% { box-shadow: 0 0 0 10px rgba(255, 68, 68, 0); }
	100% { box-shadow: 0 0 0 0 rgba(255, 68, 68, 0); }
}

#hey-wapuu-root .hw-input-area input {
	flex: 1;
	border: 2px solid #dcdcde !important;
	border-radius: 25px !important;
	padding: 10px 20px !important;
	font-size: 14px !important;
	margin: 0 !important;
	height: 44px !important;
	background: white !important;
	color: var(--hw-dark) !important;
	transition: border-color 0.2s;
}

#hey-wapuu-root .hw-input-area input:focus {
	border-color: var(--hw-primary) !important;
	outline: none !important;
	box-shadow: 0 0 0 3px rgba(0, 124, 186, 0.1) !important;
}

#hey-wapuu-root .hw-send-btn {
	background: var(--hw-primary);
	border: none;
	border-radius: 50%;
	width: 44px;
	height: 44px;
	cursor: pointer;
	color: white;
	display: flex;
	align-items: center;
	justify-content: center;
	font-weight: 700;
	transition: transform 0.2s, background 0.2s;
	flex-shrink: 0;
}

#hey-wapuu-root .hw-send-btn:hover {
	background: var(--hw-primary);
	transform: scale(1.05) rotate(5deg);
}

/* Suggestions & Dynamic Learning */
#hey-wapuu-root .hw-suggestions {
	display: flex;
	flex-wrap: wrap;
	gap: 8px;
	padding: 12px;
	background: #f8fafc;
	border-top: 1px solid #e2e8f0;
	max-height: 200px;
	overflow-y: auto;
}

#hey-wapuu-root .hw-match-card {
	background: white;
	border: 1px solid #cbd5e1;
	border-radius: 10px;
	padding: 8px 12px;
	cursor: pointer;
	text-align: left;
	transition: all 0.2s ease;
	flex: 1 1 calc(50% - 8px);
	display: flex;
	flex-direction: column;
	box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}

#hey-wapuu-root .hw-match-card:hover {
	border-color: var(--hw-primary);
	background: #fff;
	transform: translateY(-2px);
	box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
}

#hey-wapuu-root .hw-match-card strong {
	color: var(--hw-primary);
	font-size: 12px;
	display: block;
	white-space: nowrap;
	overflow: hidden;
	text-overflow: ellipsis;
}

#hey-wapuu-root .hw-match-card span {
	font-size: 10px;
	color: #64748b;
	line-height: 1.2;
}

@keyframes hw-slide-up {
	from { transform: translateY(10px); opacity: 0; }
	to { transform: translateY(0); opacity: 1; }
}

/* --- LOADING PROGRESS --- */
#hey-wapuu-root .hw-progress-container {
	height: 4px;
	background: rgba(0,0,0,0.1);
	width: 100%;
	position: relative;
	overflow: hidden;
}

#hey-wapuu-root .hw-progress-bar {
	height: 100%;
	background: var(--hw-yellow);
	transition: width 0.3s ease;
	box-shadow: 0 0 10px rgba(255, 206, 0, 0.5);
}

#hey-wapuu-root .hw-input-area.is-disabled {
	opacity: 0.6;
	pointer-events: none;
	background: #fcfcfc;
}

#hey-wapuu-root .hw-input-area.is-disabled input {
	background: #f0f0f1 !important;
	cursor: not-allowed;
}

#hey-wapuu-root .hw-thinking span {
	display: inline-block;
	font-size: 24px;
	line-height: 1;
	animation: hw-dot-jump 1.4s infinite both;
}
#hey-wapuu-root .hw-thinking span:nth-child(2) { animation-delay: .2s; }
#hey-wapuu-root .hw-thinking span:nth-child(3) { animation-delay: .4s; }

@keyframes hw-dot-jump {
	0%, 80%, 100% { transform: translateY(0); opacity: 0.3; }
	40% { transform: translateY(-5px); opacity: 1; }
}
